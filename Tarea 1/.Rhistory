table.placement = "!htbp",
single.row = T)
stargazer(reg15.2,
title= "Cuadro 2.9. Regresión con cuatro variables explicativas que explican la tasa de crecimiento de la inversión, respecto de un trimestre anterior",
column.labels = c("reg11.2","reg12.2","reg13.2","reg14.2"),
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Con cuatro variables explicativas",
dep.var.labels = "Tasa de crecimiento de la inversión respecto de un trimestre",
covariate.labels = c("Crec. trim. PIB", "Crec. trim. PIB(-1)", "Tasa de interés", "Crec. trim.  Inversión(-1)"),
notes.label = "Nivel de significancia (P-valor)",
type="latex",
table.placement = "!htbp",
single.row = T)
library(readxl)
basef<- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/Tarea-2/Datos%20Tarea%202/2F.csv")
### esto sirve para generar el periodo de estudio
datef <- seq(as.Date("2004/3/1"), as.Date("2020/9/30"), by = "quarter")
### unifica bases de datos
basefn <- cbind(datef, basef)
#Dentro de la base "basend", creo otras variables, conservando las que ya tiene. Las nuevas variables son la tasa de crecimiento de la inversión y del PIB con respecto del año anterior, es decir, con 4 rezagos.
basefn<- mutate(basefn,tI_f= (basefn$I_f-lag(basefn$I_f,4))/lag(basefn$I_f,4)*100)
basefn<-mutate(basefn,tY_f= (basefn$Y_f-lag(basefn$Y_f,4))/lag(basefn$Y_f,4)*100)
#Lo mismo pero con respecto del trimestre anterior, es decir, con 1 rezago.
basefn<- mutate(basefn,tI_f2= (basefn$I_f-lag(basefn$I_f,1))/lag(basefn$I_f,1)*100)
basefn<-mutate(basefn,tY_f2= (basefn$Y_f-lag(basefn$Y_f,1))/lag(basefn$Y_f,1)*100)
#Creo la nueva base "baser", en la cual le quito los primeros cuatro trimestres a la base "basend", puesto que tiene NA en todas las variables que son tasas de crecimiento, así que esta nueva base empieza desde 1996.
baseg<-basefn[-c(1:4),]
reg31 <- lm(baseg$tI_f ~ baseg$CE_f)
reg32 <- lm(baseg$tI_f2 ~ baseg$CE_f)
reg33 <- lm(baseg$tI_f ~ lag(baseg$CE_f))
reg34 <- lm(baseg$tI_f2 ~ lag(baseg$CE_f))
stargazer(reg31,reg33,
title= "Cuadro 2.11. Regresiones que explican la tasa de crecimiento trimestral de la inversión, respecto al trimestre del año anterior",
column.labels = c("reg1.1","reg2.1"),
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Con una sola variable explicativa",
dep.var.labels = "Tasa de crecimiento de la inversión",
covariate.labels = c("CE", "CE(-1)"),
notes.label = "Nivel de significancia (P-valor)",
type="latex",
table.placement = "!htbp",
single.row = T)
stargazer(reg32,reg34,
title= "Cuadro 2.12. Regresiones que explican la tasa de crecimiento trimestral de la inversión, respecto al trimestre anterior",
column.labels = c("reg1.2","reg2.2"),
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Con una sola variable explicativa",
dep.var.labels = "Tasa de crecimiento de la inversión",
covariate.labels = c("CE", "CE(-1)"),
notes.label = "Nivel de significancia (P-valor)",
type="latex",
table.placement = "!htbp",
single.row = T)
reg55 <- lm(baseg$tI_f ~ baseg$tY_f+baseg$CE_f)
reg56 <- lm(baseg$tI_f ~ baseg$Rr_f+baseg$CE_f)
reg57 <- lm(baseg$tI_f ~ baseg$tY_f+lag(baseg$CE_f))
reg58 <- lm(baseg$tI_f ~ lag(baseg$tY_f)+lag(baseg$CE_f))
reg59 <- lm(baseg$tI_f ~ lag(baseg$Rr_f)+lag(baseg$CE_f))
reg60 <- lm(baseg$tI_f ~ baseg$tY_f+baseg$CE_f+baseg$Rr_f)
reg61 <- lm(baseg$tI_f ~ lag(baseg$tY_f)+lag(baseg$CE_f)+lag(baseg$Rr_f))
reg62 <- lm(baseg$tI_f ~ lag(baseg$tY_f)+lag(baseg$CE_f)+baseg$Rr_f)
stargazer(reg60,reg61,reg62,
title= "Cuadro 2.14. Regresiones que explican la tasa de crecimiento trimestral de la inversión, respecto al trimestre anterior",
column.labels = c("reg8","reg9","reg10"),
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Con tres variables explicativas",
dep.var.labels = "Tasa de crecimiento de la inversión",
covariate.labels = c("Crec. anual PBI","CE","Tasa de interés","Crec. anual PBI(-1)","CE(-1)","Tasa de interés(-1)"),
notes.label = "Nivel de significancia (P-valor)",
type="latex",
table.placement = "!htbp",
single.row = T)
reg63 <- lm(baseg$tI_f ~ baseg$tY_f+baseg$Rr_f+baseg$CE_f+lag(baseg$tI_f))
reg64 <- lm(baseg$tI_f ~ baseg$tY_f+lag(baseg$tY_f)+baseg$Rr_f+baseg$CE_f)
reg65 <- lm(baseg$tI_f ~ lag(baseg$tY_f)+baseg$Rr_f+baseg$CE_f+lag(baseg$tI_f))
stargazer(reg63,reg64,reg65,
title= "Cuadro 2.15. Regresiones que explican la tasa de crecimiento trimestral de la inversión, respecto al trimestre anterior",
column.labels = c("reg11","reg12","reg13"),
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Con cuatro variables explicativas",
dep.var.labels = "Tasa de crecimiento de la inversión",
covariate.labels = c("Crec. anual PBI","Crec. anual PBI(-1)" ,"Tasa de interés","CE","Crec. anual Inversión(-1)"),
notes.label = "Nivel de significancia (P-valor)",
type="latex",
table.placement = "!htbp",
single.row = T)
library(readxl)
basefe<- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/Tarea-2/Datos%20Tarea%202/2Fextension.csv")
### esto sirve para generar el periodo de estudio
datef <- seq(as.Date("1995/3/1"), as.Date("2020/9/30"), by = "quarter")
### unifica bases de datos
basefc <- cbind(datef, basefe)
#Dentro de la base "basend", creo otras variables, conservando las que ya tiene. Las nuevas variables son la tasa de crecimiento de la inversión y del PIB con respecto del año anterior, es decir, con 4 rezagos.
basefc<- mutate(basefc,tIPr= (basefc$IPr-lag(basefc$IPr,4))/lag(basefc$IPr,4)*100)
basefc<- mutate(basefc,tPIB= (basefc$PIB-lag(basefc$PIB,4))/lag(basefc$PIB,4)*100)
basefc<- mutate(basefc,tIPub= (basefc$IPub-lag(basefc$IPub,4))/lag(basefc$IPub,4)*100)
#Creo la nueva base "baser", en la cual le quito los primeros cuatro trimestres a la base "basend", puesto que tiene NA en todas las variables que son tasas de crecimiento, así que esta nueva base empieza desde 1996.
basefa<-basefc[-c(1:4),]
reg66 <- lm(basefa$tIPr ~ basefa$tPIB+basefa$Rr+basefa$tIPub)
stargazer(reg66,
title= "Cuadro 2.16. Regresiones que explican la tasa de crecimiento trimestral de la inversión, respecto al trimestre anterior",
column.labels = c("reg14"),
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Con tres variables explicativas",
dep.var.labels = "Tasa de crecimiento de la inversión",
covariate.labels = c("Crec. anual PBI","Tasa de interes","Crec. anual Inv Pública"),
notes.label = "Nivel de significancia (P-valor)",
type="latex",
table.placement = "!htbp",
single.row = T)
bd_liverpool<- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/Tarea-2/Datos%20Tarea%202/bd_liverpool.csv")
tasaactivosTT<- ts(bd_liverpool$tasa_activos_trimtrim, start=c(2007,2), frequency = 4)
grafica_tc_activos1<- plot.ts(tasaactivosTT, xlab="Trimestres", ylab="Tasa de crecimiento", main="Gráfica 3.1. Tasa de crecimiento trimestral del valor de los activos\n de El Puerto de Liverpool, 2007T3 - 2020T4", col = "blue", lwd=1, cex.main = 0.9)
tasaactivosTA<- ts(bd_liverpool$tasa_activos_trimanual, start=c(2007,2), frequency = 4)
grafica_tc_activos2<- plot.ts(tasaactivosTA, xlab="Trimestres", ylab="Tasa de crecimiento", main="Gráfica 3.2. Tasa de crecimiento trimestral del valor de los activos\n de El Puerto de Liverpool, con respecto al año anterior, 2008T2 - 2020T4", col = "red", lwd=1, cex.main = 0.9)
tasacapitalTT<- ts(bd_liverpool$tasa_capital_trimtrim, start=c(2007,2), frequency = 4)
grafica_tc_capial1<- plot.ts(tasacapitalTT, xlab="Trimestres", ylab="Tasa de crecimiento", main="Gráfica 3.3. Tasa de crecimiento trimestral del capital\n de El Puerto de Liverpool, 2007T3 - 2020T4", col = "green", lwd=1, cex.main = 0.9)
tasacapitalTA<- ts(bd_liverpool$tasa_capital_trimanual, start=c(2007,2), frequency = 4)
grafica_tc_capial1<- plot.ts(tasacapitalTA, xlab="Trimestres", ylab="Tasa de crecimiento", main="Gráfica 3.4. Tasa de crecimiento trimestral del capital\n de El Puerto de Liverpool, con respecto al año anterior, 2008T2 - 2020T4", col = "cyan", lwd=1, cex.main = 0.9)
qT<-(bd_liverpool$precio_acciones*bd_liverpool$num_acciones)/(bd_liverpool$activos_totales-bd_liverpool$pasivos_totales)
qT_ts<- ts(qT, start=c(2007,2), frequency = 4)
grafica_qT <- plot.ts (qT_ts,   xlab="Trimestres", ylab="q de Tobin", main="Gráfica 3.5. Medida de la q de Tobin\n de El Puerto de Liverpool, 2007T2 - 2020T4", col = "purple", lwd=1, cex.main = 0.9)
abline(h = mean(qT_ts), col ="red", legend("topright", "Media", fill = "red"))
mean(qT_ts)
qT_ts1 <- stats::lag(qT_ts, k = -1)
qT_ts1
scatter.smooth(x = qT_ts1, y = tasaactivosTT, span = 1, main = "Gráfica 3.6. q de Tobin y crecimiento de los activos trimestre-trimestre.", xlab = "q de Tobin", ylab = "Crecimiento valor activos", col = "#333399", cex = 0.5, cex.main = 0.8)
regg3.1 <- lm(tasaactivosTT ~ qT_ts1)
stargazer(regg3.1,
title= "Cuadro 3.3. Regresión q de Tobin y crecimiento de los activos trimestre-trimestre.",
column.labels = "",
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Variable Dependiente",
dep.var.labels = "Crecimiento valor activos",
covariate.labels = c("q de Tobin", "Constante"),
notes.label = "P-valor",
type="latex",
table.placement = "!htbp")
scatter.smooth(x = qT_ts1, y = tasaactivosTA, span = 1, main = "Gráfica 3.7.q de Tobin y crecimiento de los activos trimestre/anual.", xlab = "q de Tobin", ylab = "Crecimiento valor activos", col = "#333399", cex = 0.5, cex.main = 0.8)
regg3.2 <- lm(tasaactivosTA ~ qT_ts1)
stargazer(regg3.2,
title= "Cuadro 3.4. Regresión q de Tobin y crecimiento de los activos trimestre/anual.",
column.labels = "",
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Variable Dependiente",
dep.var.labels = "Crecimiento valor activos",
covariate.labels = c("q de Tobin", "Constante"),
notes.label = "P-valor",
type="latex",
table.placement = "!htbp")
scatter.smooth(x = qT_ts1, y = tasacapitalTT, span = 1, main = "Gráfica 3.8.q de Tobin y crecimiento del capital trimestre-trimestre", xlab = "q de Tobin", ylab = "Crecimiento capital", col = "#333399", cex = 0.5, cex.main = 0.8)
regg3.3 <- lm(tasacapitalTT ~ qT_ts1)
stargazer(regg3.3,
title= "Cuadro 3.5. Regresión q de Tobin y crecimiento del capital trimestre-trimestre.",
column.labels = "",
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Variable Dependiente",
dep.var.labels = "Crecimiento capital",
covariate.labels = c("q de Tobin", "Constante"),
notes.label = "P-valor",
type="latex",
table.placement = "!htbp")
scatter.smooth(x = qT_ts1, y = tasacapitalTA, span = 1, main = "Gráfica 3.9.q de Tobin y crecimiento del capital trimestre/anual", xlab = "q de Tobin", ylab = "Crecimiento capital", col = "#333399", cex = 0.5, cex.main = 0.8)
regg3.4 <- lm(tasacapitalTA ~ qT_ts1)
stargazer(regg3.4,
title= "Cuadro 3.6. Regresión q de Tobin y crecimiento del capital trimestre/anual",
column.labels = "",
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Variable Dependiente",
dep.var.labels = "Crecimiento capital",
covariate.labels = c("q de Tobin", "Constante"),
notes.label = "P-valor",
type="latex",
table.placement = "!htbp")
C1 <- 0.9310987*(15194678400/50684928000)^2*50684928000
C1
C2 <- 0.3885*(15194678400/50684928000)^2*50684928000
C2
C3 <- 1.9455*(15194678400/50684928000)^2*50684928000
C3
set.seed(1)
epsilon<-c(rnorm(55,0,0.2))
cepsilon<-c(rnorm(55,0,0.2))
qTe<-qT_ts1+epsilon
qTce<-qT_ts1-cepsilon
reg_1<-lm(tasaactivosTT ~ qT_ts1)
reg_e<-lm(tasaactivosTT ~ qTe)
reg_ce<-lm(tasaactivosTT ~ qTce)
stargazer(reg_1,reg_e, reg_ce,
title= "Cuadro 3.10. Regresiones 3.9 - 3.11. Inversión (crecimiento de los activos) y  la q de Tobin con elemento de error",
column.labels = "",
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Variable Dependiente",
dep.var.labels = "Crecimiento activos T",
covariate.labels = c("q de Tobin"),
notes.label = "P-valor",
type="latex",
table.placement = "!htbp")
reg1_efectivo <- lm(tasaactivosTT ~ qT_ts1 + bd_liverpool$Efectivo)
reg2_efectivo <- lm(tasaactivosTA ~ qT_ts1 + bd_liverpool$Efectivo)
reg3_efectivo <- lm(tasacapitalTT ~ qT_ts1 + bd_liverpool$Efectivo)
reg4_efectivo <- lm(tasacapitalTA ~ qT_ts1 + bd_liverpool$Efectivo)
stargazer(reg1_efectivo,reg2_efectivo, reg3_efectivo, reg4_efectivo,
title= "Cuadro 3.11. Regresión 3.5(1) - 3.8(4). Inversión (crecimiento de los activos y del capital),  la q de Tobin, y el efectivo.",
column.labels = "",
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Variable Dependiente",
#dep.var.labels = "Crecimiento activos T",
covariate.labels = c("q de Tobin", "Efectivo"),
notes.label = "P-valor",
type="latex",
table.placement = "!htbp")
datosej3 <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/Tarea-1/Datos%20Tarea%201/datos_ejercicio3.csv")
#imagen1 <- load.image("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/Tarea-2/Datos%20Tarea%202/gr%C3%A1fica_9.7_a.PNG")
plot(imagen1, main = "Figura 1.1. Diagrama de fase: Una guerra destruye la mitad \n del stock de capital de la economía", axes = FALSE, cex.main = 0.8)
imagen1 <- load.image("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/Tarea-2/Datos%20Tarea%202/gr%C3%A1fica_9.7_a.PNG")
plot(imagen1, main = "Figura 1.1. Diagrama de fase: Una guerra destruye la mitad \n del stock de capital de la economía", axes = FALSE, cex.main = 0.8)
knitr::opts_chunk$set(echo = F, fig.width = 6, fig.height = 3.5)
rm(list = ls())
pacman::p_load(tidyverse,
kableExtra,
ggplot2,
cowplot,
stargazer,knitr,viridis,dplyr,readr,scales,quantmod,texreg,tinytex, tidyr, imager,lubridate,tseries, astsa, growthrates, tis, dynlm, readxl, foreign)
bdanual <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%203/Datos/bd_lab_anual.csv")
salario_anual <- ts(bdanual$salario_anual_totreal, start=2007, frequency = 1)
ts.plot (salario_anual,   xlab="Años", ylab="Salario anual promedio", main="Gráfica 2.1 Salario promedio anual en México, base 2019.", col="blue", lwd=2)
volatil_salario<-sd(salario_anual)
tc_salario_anual <- growth.rate(salario_anual, lag=1)
volatil_tc_salario<-sd(tc_salario_anual)
ts.plot (tc_salario_anual,   xlab="Años", ylab="Tasa de crecimiento", main="Gráfica 2.2 Tasa de crecimiento del salario en México.", col="blue", lwd=2)
abline(h = mean(tc_salario_anual), col ="red", legend("bottomright", "Media", fill = "red"))
abline(h = mean(tc_salario_anual)-sd(tc_salario_anual), col ="green", legend("bottomleft", "sd(2.12)", fill = "green"))
abline(h = mean(tc_salario_anual)+sd(tc_salario_anual), col ="green", legend("bottomleft", "sd(2.12)", fill = "green"))
empleo_anual <- ts(bdanual$po_tot, start=2007, frequency = 1)
ts.plot (empleo_anual,   xlab="Años", ylab="Empleos", main="Gráfica 2.3 Número de empleos en México de 2007 a 2020.", col="blue", lwd=2)
volatil_empleo<-sd(empleo_anual)
tc_empleo_anual <- growth.rate(empleo_anual, lag=1)
volatil_tc_empleo<-sd(tc_empleo_anual)
ts.plot (tc_empleo_anual,   xlab="Años", ylab="Tasa de crecimiento", main="Gráfica 2.4 Tasa de crecimiento del empleo anual en México.", col="blue", lwd=2)
abline(h = mean(tc_empleo_anual), col ="red", legend("topleft", "Media", fill = "red"))
abline(h = mean(tc_empleo_anual)-sd(tc_empleo_anual), col ="green", legend("bottomleft", "sd(2.46)", fill = "green"))
abline(h = mean(tc_empleo_anual)+sd(tc_empleo_anual), col ="green", legend("bottomleft", "sd(2.46)", fill = "green"))
pib_anual <- ts(bdanual$pib_tot, start=2007, frequency = 1)
ts.plot (pib_anual,   xlab="Años", ylab="PIB", main="Gráfica 2.5 PIB de México de 2007 a 2020,  millones de pesos.", col="blue", lwd=2)
volatil_pib<-sd(pib_anual)
tc_pib_anual <- growth.rate(pib_anual, lag=1)
volatil_tc_pib<-sd(tc_pib_anual)
ts.plot (tc_pib_anual,   xlab="Años", ylab="Tasa de crecimiento", main="Gráfica 2.6 Tasa de crecimiento del PIB anual en México.", col="blue", lwd=2)
abline(h = mean(tc_pib_anual), col ="red", legend("topleft", "Media", fill = "red"))
abline(h = mean(tc_pib_anual)-sd(tc_pib_anual), col ="green", legend("bottomleft", "sd(3.78)", fill = "green"))
abline(h = mean(tc_pib_anual)+sd(tc_pib_anual), col ="green", legend("bottomleft", "sd(3.78)", fill = "green"))
tc_salario_anual<- ts(tc_salario_anual, start=2008, frequency = 1)
tc_empleo_anual<- ts(tc_empleo_anual, start=2008, frequency = 1)
tc_pib_anual<- ts(tc_pib_anual, start=2008, frequency = 1)
ts.plot (tc_salario_anual, tc_empleo_anual, tc_pib_anual, gpars=list(xlab="Años", ylab="Tasas de crecimiento", main=" Gráfica 2.7 Tasas de crecimiento del empleo, salarios y PIB en México.", col=c("green","blue","red"),lwd= 2, cex.main=0.9))
legend ('bottom', col=c("green","blue","red"),lwd=3, legend=c("Salario","Empleo","PIB"), bg='white',bty="n",cex=0.7)
cov_sal_pib<-cov(salario_anual,pib_anual, method = c("pearson"))
cov_tc_sal_pib<-cov(tc_salario_anual,tc_pib_anual, method = c("pearson"))
cov_empleo_pib<-cov(empleo_anual,pib_anual, method = c("pearson"))
cov_tc_empleo_pib<-cov(tc_empleo_anual,tc_pib_anual, method = c("pearson"))
cor_tc_salario_pib<-cor(salario_anual,pib_anual, method = c("pearson"))
cor_tc_empleo_pib<-cor(empleo_anual,pib_anual, method = c("pearson"))
Base_de_datos_ejercicio_3 <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%203/Datos/Base%20de%20datos%20ejercicio%203.csv",
col_types = cols(Fecha = col_date(format = "%d/%m/%Y")))
Base_de_datos_ejercicio_3$"F(K,L)" <- Base_de_datos_ejercicio_3$`Índice de volumen físico acumulado (base 2013, promedio trimestral)`^0.3*Base_de_datos_ejercicio_3$`Población económicamente activa`^0.7
Base_de_datos_ejercicio_3$"Productividad A" <- Base_de_datos_ejercicio_3$`PIB en millones de pesos (base 2013)`/ Base_de_datos_ejercicio_3$"F(K,L)"
Base_de_datos_ejercicio_3$"Índice Productividad" <- Base_de_datos_ejercicio_3$`Productividad A`*100/16.63102398528814
mean(Base_de_datos_ejercicio_3$`Índice Productividad`)
max(Base_de_datos_ejercicio_3$`Índice Productividad`)
min(Base_de_datos_ejercicio_3$`Índice Productividad`)
serie3.1 <- ts(Base_de_datos_ejercicio_3, start= c(2000,2), frequency = 4)
productividad <- serie3.1[,7]
ts.plot (productividad, gpars=list(xlab="Trimestres", ylab="Índice", main="Gráfica 3.1. Índice de productividad trimestral, 2000 - 2020.",  col=5:1, lwd=1))
Base_de_datos_ejercicio_3$"Salario contrafactual" <- Base_de_datos_ejercicio_3$`Índice Productividad`*0.7*Base_de_datos_ejercicio_3$`Índice de volumen físico acumulado (base 2013, promedio trimestral)`^0.3/Base_de_datos_ejercicio_3$`Población económicamente activa`^0.3
mean(Base_de_datos_ejercicio_3$`Salario contrafactual`)
max(Base_de_datos_ejercicio_3$`Salario contrafactual`)
min(Base_de_datos_ejercicio_3$`Salario contrafactual`)
serie3.1 <- ts(Base_de_datos_ejercicio_3, start= c(2000,2), frequency = 4)
salariocontrafactual <- serie3.1[,8]
ts.plot (salariocontrafactual, gpars=list(xlab="Trimestres", ylab="Índice", main="Gráfica 3.2. Salario contrafactual, 2000 - 2020.",  col=5:1, lwd=1))
Salarios_ejercicio_3 <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%203/Datos/Salario%20real%202007-2020.csv",
col_types = cols(Fecha = col_date(format = "%d/%m/%Y")))
Base_de_datos_ejercicio_3$"Índice Salario contrafactual" <- Base_de_datos_ejercicio_3$`Salario contrafactual`*100/1.3534931427529
serie3.2 <- ts(Salarios_ejercicio_3, start= c(2007,1), frequency = 4)
salarioreal <- serie3.2[,2]
serie3.3 <- ts(Base_de_datos_ejercicio_3, start= c(2000,2), frequency = 4)
salariocontrafactual1 <- serie3.3[,9]
ts.plot (salariocontrafactual1, salarioreal, gpars=list(xlab="Trimestres", ylab="Índice", main="Gráfica 3.3. Salarios contrafactual y observado, 2000 - 2020.",  col=7:6, lwd=1))
legend("topleft", bty="n", lty=c(1,1), col=7:6,
legend=c(" Salario contrafactual ", "Salario real "))
imagen4.1 <- load.image("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%203/Datos/4a_1_Imagen_Matriz_Hussmanns.PNG")
plot(imagen4.1, main = "Figura 4.1. Matriz de Hussmanns para México.", cex.main = 5, axes = FALSE)
imagen4.2 <- load.image("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%203/Datos/4a_2_Matriz_Hussmanns_Inegi.PNG")
plot(imagen4.2, main = "Figura 4.2. Matriz de Hussmanns para México, \n último trimestre 2020.", axes = FALSE, cex.main = 0.8)
#Subo los datos. Estos datos corresponden a la matriz hussmanns que proporciona el INEGI, que pertenecen a la imagen de arriba.
library(readxl)
dataej4b <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%203/Datos/dataej4b.csv")
b_4 <- dataej4b[5,11]/dataej4b[6,13]
# Creo la variable c que es igual a la suma de los valores de renglones del 2 al 4 de la columna 1 + la suma de los valores de los renglones 2 al 4 de la fila 3.
c_4 <- colSums (dataej4b[2:4 , 1]) + colSums (dataej4b[2:4,3])
#a la misma variable le sumo el valor que se encuentra en la posición (4,7)
c_4 <- c_4 + dataej4b[4,7]
#Ahora le sumo los valores que se encuentran del renglón 3 al cuatro dela columna 9
c_4 <- c_4 + colSums(dataej4b[3:4,9])
#Hasta este momento, c_4 representa la suma de todos los trabajadores del sector formal que son informales.
#Obtengo la proporción de trabajadores del sector formal que son informales dividiendo este número entre el total de trabajadores.
c_4_2 <- c_4 / dataej4b[6,13]
# Número de trabajadores que conforman el sector formal
c_4_3 <- colSums(dataej4b[2:4,13])
imagen4.3 <- load.image("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%203/Datos/4d_Imagen.PNG")
plot(imagen4.3, main = "Figura 4.3. Proporción de trabajadores informales en el sector formal.", axes = FALSE, cex.main = 0.8)
imagen4.4 <- load.image("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%203/Datos/4d_2_2.PNG")
plot(imagen4.4, main = "Figura 4.4. Proporción de trabajadores informales por entidad federativa.", axes = FALSE, cex.main = 0.8)
imagen4.5 <- load.image("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%203/Datos/4d_2_2.PNG")
plot(imagen4.5, main = "Figura 4.5. Salario por industria e informalidad.", axes = FALSE, cex.main = 0.8)
#Subo los datos. Estos datos corresponden a la imagen de arriba.
library(readxl)
dataej4e <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%203/Datos/dataej4e.csv")
# Grafico los puntos ($\% \Delta Y_t$,$\% \Delta I_t$) poniendo la inversión en el eje la ordenadas
scatter.smooth(x=dataej4e$ptisf, y=dataej4e$Ingreso, xlab="Proporción de trabajadores informales en la economía mexicana", ylab="Salario (pesos)", main="Gráfica 4.1. Nivel de informalidad y salario. ", col="magenta", lwd=4, cex=0.5)
imagen4.6 <- load.image("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%203/Datos/4f_Matriz_Hussmanns2008_Inegi.PNG")
plot(imagen4.6, main = "Figura 4.6. Matriz Hussmans del cuarto trimestre de 2008.", axes = FALSE, cex.main = 0.8)
#Subo los datos. Estos datos corresponden a la matriz hussmanns que proporciona el INEGI, que pertenecen a la imagen de arriba.
library(readxl)
dataej4f <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%203/Datos/dataej4f.csv")
#Creo la variabla f_4 (ejercicio 4, inciso f), el cuál corresponde a la suma de los valores del renglón 2 al 4 de la columna 11
f_4_1 <- colSums (dataej4f[1:4 , 11])
#Divido este valor que representa el total de trabajadores del sector formal que son informales, entre el número de trabajadores que conformal el sector formal
f_4_2 <- f_4_1 / colSums(dataej4f[1:4,13])
#Subo datos. Estos datos corresponden a la tasa de ocupación del sector informal (TOSI) y a la tasa de informalidad laboral (TIL) con datos trimestrales a partir del 2005 al primer trimestre de 2020, obtenidos del INEGI con el fin de ver el comportamiento de la informalidad durante las crisis.
library(readxl)
dataej4f_2 <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%203/Datos/dataej4f_2.csv")
#Convierto estas variables en series de tiempo
TOSI <- ts(dataej4f_2$TOSI, start=2005, frequency = 4)
TIL <- ts(dataej4f_2$TIL, start=2005, frequency = 4)
ts.plot (TIL, xlab="trimestres", ylab="porcentaje", main="Gráfica 4.2 Tasa de informalidad laboral.", col="blue")
ts.plot (TOSI, xlab="trimestres", ylab="porcentaje", main="Gráfica 4.3 Tasa de ocupación del sector informal.", col="blue")
knitr::opts_chunk$set(echo = F, fig.width = 6, fig.height = 3.5)
rm(list = ls())
pacman::p_load(tidyverse,
kableExtra,
ggplot2,
cowplot,
stargazer,knitr,viridis,dplyr,readr,scales,quantmod,texreg,tinytex, tidyr, imager,lubridate,tseries, astsa, growthrates, tis, dynlm, readxl, foreign, hrbthemes)
captaciones3 <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%204/Datos/Ejercicio%203_captaciones.csv")
captaciones3<- ts(captaciones3, start=1986, frequency = 1)
ts.plot (captaciones3[,3], captaciones3[,5], captaciones3[,7], captaciones3[,9], captaciones3[,11], captaciones3[,13], captaciones3[,15], captaciones3[,17], captaciones3[,19], gpars=list(xlab="Años", ylab="Valor", main=" Gráfica 2.1. Niveles deflactados de los instrumentos \n de financiación de la banca comercial, 1986-2020, base 2018", col=c("black", "green","blue","cyan", "yellow", "orange", "purple", "brown", "red"),lwd= 1, cex.main=0.9))
legend ('topleft', col=c("black", "green","blue","cyan", "yellow", "orange", "purple", "brown", "red"),lwd=3, legend=c("Total", "Cuentas de cheques","A la vista","Depósitos de nómina", "Cuentas de ahorro", "Depósitos retirables", "Depósitos a plazo", "Pagarés", "Banca de inversión"), bg='white',bty="n",cex=0.7)
captaciones3.1 <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%204/Datos/Ejercicio%203_captaciones2.csv")
ggplot(captaciones3.1, aes(x=captaciones3.1$time, y=captaciones3.1$percentage, fill=captaciones3.1$group)) +
geom_area(alpha=0.7 , size=0.2, colour="black") +
xlab("Tiempo") +
ylab("Porcentaje") +
labs(fill = "Instrumento") +
ggtitle("Gráfica 2.2. Participación porcentual de instrumentos de \n financiación de la banca comercial") +
theme(
plot.title = element_text(color="black", size=12, face="bold", hjust= c(0.5))
)
financiamiento3 <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%204/Datos/Ejercicio%203_financiamiento.csv")
financiamiento3<- ts(financiamiento3, start=2004, frequency = 12)
ts.plot (financiamiento3[,3], financiamiento3[,5], financiamiento3[,7], financiamiento3[,9], financiamiento3[,11], financiamiento3[,13], financiamiento3[,15],  gpars=list(xlab="Años", ylab="Valor", main=" Gráfica 2.3. Niveles deflactados de la financiación \n otorgada por la banca comercial, 2004-2021, base 2018", col=c("black", "green","blue","cyan", "orange", "purple", "red"),lwd= 1, cex.main=0.9))
legend ('topleft', col=c("black", "green","blue","cyan", "orange", "purple", "red"),lwd=3, legend=c("Total", "Sector privado no financiero","Secor financiero no bancario","Sector público", "Otros sectores", "Sector externo", "Crédito a banca comercial"), bg='white',bty="n",cex=0.7)
financiamiento3.2 <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%204/Datos/Ejercicio%203_financiamiento2.csv",
col_types = cols(time = col_date(format = "%d/%m/%Y")))
ggplot(financiamiento3.2, aes(x=financiamiento3.2$time, y=financiamiento3.2$percentage, fill=financiamiento3.2$group)) +
geom_area(alpha=0.7 , size=0.2, colour="black") +
xlab("Tiempo") +
ylab("Porcentaje") +
labs(fill = "Instrumento") +
ggtitle("Gráfica 2.4. Participación porcentual de la financiación de \n otorgada por la banca comercial, 2004-2021") +
theme(
plot.title = element_text(color="black", size=12, face="bold", hjust= c(0.5))
)
hipotecas3 <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%204/Datos/Ejercicio%203_creditohipotecario.csv",
col_types = cols(time = col_date(format = "%d/%m/%Y")))
hipotecas3<- ts(hipotecas3, start=c(1996,4), frequency = 4)
ts.plot (hipotecas3[,4],  gpars=list(xlab="Años", ylab="Porcentaje", main=" Gráfica 2.5. Financiamiento hipotecario \n como proporción del PIB, 1994 - 2020, trimestral.", col=c("blue"),lwd= 2, cex.main=0.9))
valgob<-read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%204/Datos/instrum_gob.csv")
valgob_add<-valgob
valgob_add$bondesd<-valgob_add$bondes_tot+valgob_add$bondesD_tot
valgob_add$cetes_en_tot<-(valgob_add$cetes_tot/valgob_add$valores_gob_tot)*100
valgob_add$bondesd_en_tot<-(valgob_add$bondesd/valgob_add$valores_gob_tot)*100
valgob_add$udibonos_en_tot<-(valgob_add$udibonos_tot/valgob_add$valores_gob_tot)*100
valgob_add$bonos_en_tot<-(valgob_add$bonos_tot/valgob_add$valores_gob_tot)*100
tab1<-tibble(valgob_add$cetes_en_tot, valgob_add$bondesd_en_tot, valgob_add$udibonos_en_tot, valgob_add$bonos_en_tot)
tab2<-t(tab1)
tab2<-as.array(tab2)
tab_inst<-as.data.frame(c(1, data=tab2))
tab_inst<-tab_inst[-c(1),]
tab_inst<-as.data.frame(tab_inst)
tiempo <- data.frame(seq(as.Date("2009/08/1"), by = "month", length.out = 141)-1)
tiempo$veces<-rep(4,times=141)
names(tiempo)<-c("fecha","veces")
expanded <-tiempo[rep(row.names(tiempo), tiempo$veces), ]
data.frame(expanded,Date=expanded$fecha+(sequence(tiempo$veces)-1))
nombres <- rep(c("CETES", "BONDESD", "UDIBONOS", "BONOS"),times=141)
nombres<-as.data.frame(nombres)
instrumentos<-tibble(expanded$fecha, tab_inst$tab_inst, nombres$nombres)
names(instrumentos)<-c("Meses","Participacion", "Instrumentos")
ggplot(instrumentos, aes(x=Meses, y=Participacion, fill=Instrumentos)) +
geom_area(alpha=0.7, size=0.2, colour="black")+ggtitle("Gráfica 3.1 Evolución de la composición de los títulos de deuda gubernamental \n emitidos localmente, de julio de 2009 a marzo de 2021 (porcentual)") +
theme(
plot.title = element_text(color="black", size=10, face="bold", hjust= c(0.5))
)
figura1<- load.image("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%204/clasif_deuda_local.png")
plot(figura1, main = "Cuadro 3.2: Clasificación de emisiones de títulos de deuda emitidos en el mercado local, marzo 2021. \n (Saldos a valor nominal en miles de millones de pesos)", cex.main = 5, axes = FALSE)
deuda<-read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/main/Tarea%204/Datos/madura_moneda.csv")
deuda_add<-deuda
deuda_add$gobfed_cp_porciento<-(deuda_add$resid_gobfed_cp/(deuda_add$resid_gobfed_cp+deuda_add$resid_gobfed_lp))*100
deuda_add$gobfed_lp_porciento<-(deuda_add$resid_gobfed_lp/(deuda_add$resid_gobfed_cp+deuda_add$resid_gobfed_lp))*100
tab11<-tibble(deuda_add$gobfed_cp_porciento,deuda_add$gobfed_lp_porciento)
tab12<-t(tab11)
tab12<-as.array(tab12)
tab_inst13<-as.data.frame(c(1, data=tab12))
tab_inst13<-tab_inst13[-c(1),]
tab_inst13<-as.data.frame(tab_inst13)
tiempo11 <- data.frame(seq(as.Date("2009/08/1"), by = "month", length.out = 141)-1)
tiempo11$veces<-rep(2,times=141)
names(tiempo11)<-c("fecha","veces")
expanded11 <-tiempo11[rep(row.names(tiempo11), tiempo11$veces), ]
data.frame(expanded11,Date=expanded11$fecha+(sequence(tiempo11$veces)-1))
nombres11 <- rep(c("Corto Plazo", "Largo Plazo"),times=141)
nombres11<-as.data.frame(nombres11)
plazo<-tibble(expanded11$fecha, tab_inst13$tab_inst, nombres11$nombres)
names(plazo)<-c("Meses","Participacion", "Plazo")
ggplot(plazo, aes(x=Meses, y=Participacion, fill=Plazo)) +
geom_area(alpha=0.7, size=0.2, colour="black")+ggtitle("Gráfica 3.2 Composición y evolución de la deuda del Gobierno Federal  \n en el Corto y Largo plazo, de julio de 2009 a marzo de 2021 ( porcentual)") +
theme(
plot.title = element_text(color="black", size=10, face="bold", hjust= c(0.5))
)
deuda_add$deuda_int_porciento<-(deuda_add$deuda_int_sp/(deuda_add$deuda_int_sp+deuda_add$deuda_ext_sp))*100
deuda_add$deuda_ext_porciento<-(deuda_add$deuda_ext_sp/(deuda_add$deuda_int_sp+deuda_add$deuda_ext_sp))*100
tab21<-tibble(deuda_add$deuda_int_porciento,deuda_add$deuda_ext_porciento)
tab22<-t(tab21)
tab22<-as.array(tab22)
tab_inst23<-as.data.frame(c(1, data=tab22))
tab_inst23<-tab_inst23[-c(1),]
tab_inst23<-as.data.frame(tab_inst23)
tiempo21 <- data.frame(seq(as.Date("2009/08/1"), by = "month", length.out = 141)-1)
tiempo21$veces<-rep(2,times=141)
names(tiempo21)<-c("fecha","veces")
expanded21 <-tiempo21[rep(row.names(tiempo21), tiempo21$veces), ]
data.frame(expanded21,Date=expanded21$fecha+(sequence(tiempo21$veces)-1))
nombres21 <- rep(c("Interna", "Externa"),times=141)
nombres21<-as.data.frame(nombres21)
deudas<-tibble(expanded21$fecha, tab_inst23$tab_inst, nombres21$nombres)
names(deudas)<-c("Meses","Participacion", "Deuda")
ggplot(deudas, aes(x=Meses, y=Participacion, fill=Deuda)) +
geom_area(alpha=0.7, size=0.2, colour="black")+ggtitle("Gráfica 3.3 Deuda neta externa e interna del sector público,  \n de julio de 2009 a marzo de 2021 (en porcentajes)") +
theme(
plot.title = element_text(color="black", size=10, face="bold", hjust= c(0.5))
)
deuda_add$priv_cp_porciento<-(deuda_add$resid_nofin_priv_cp/(deuda_add$resid_nofin_priv_cp+deuda_add$resid_nofin_priv_lp))*100
deuda_add$priv_lp_porciento<-(deuda_add$resid_nofin_priv_lp/(deuda_add$resid_nofin_priv_cp+deuda_add$resid_nofin_priv_lp))*100
tab31<-tibble(deuda_add$deuda_int_porciento,deuda_add$deuda_ext_porciento)
tab32<-t(tab31)
tab32<-as.array(tab32)
tab_inst33<-as.data.frame(c(1, data=tab32))
tab_inst33<-tab_inst33[-c(1),]
tab_inst33<-as.data.frame(tab_inst33)
tiempo31 <- data.frame(seq(as.Date("2009/08/1"), by = "month", length.out = 141)-1)
tiempo31$veces<-rep(2,times=141)
names(tiempo31)<-c("fecha","veces")
expanded31 <-tiempo31[rep(row.names(tiempo31), tiempo31$veces), ]
data.frame(expanded31,Date=expanded31$fecha+(sequence(tiempo31$veces)-1))
nombres31 <- rep(c("Corto Plazo", "Largo Plazo"),times=141)
nombres31<-as.data.frame(nombres31)
plazo31<-tibble(expanded31$fecha, tab_inst33$tab_inst, nombres31$nombres)
names(plazo31)<-c("Meses","Participacion", "Plazo")
ggplot(plazo31, aes(x=Meses, y=Participacion, fill=Plazo)) +
geom_area(alpha=0.7, size=0.2, colour="black")+ggtitle("Gráfica 3.4 Evolución de la composición de la deuda del sector \n privado no financiero en el Corto y Largo plazo, \n de julio de 2009 a marzo de 2021 (en porcentajes)") +
theme(
plot.title = element_text(color="black", size=10, face="bold", hjust= c(0.5))
)
deuda_add$priv_mn_porciento<-(deuda_add$resid_nofin_priv_monlocal/(deuda_add$resid_nofin_priv_monlocal+deuda_add$resid_nofin_priv_monextra))*100
deuda_add$priv_me_porciento<-(deuda_add$resid_nofin_priv_monextra/(deuda_add$resid_nofin_priv_monlocal+deuda_add$resid_nofin_priv_monextra))*100
tab41<-tibble(deuda_add$priv_mn_porciento,deuda_add$priv_me_porciento)
tab42<-t(tab41)
tab42<-as.array(tab42)
tab_inst43<-as.data.frame(c(1, data=tab42))
tab_inst43<-tab_inst43[-c(1),]
tab_inst43<-as.data.frame(tab_inst43)
tiempo41 <- data.frame(seq(as.Date("2009/08/1"), by = "month", length.out = 141)-1)
tiempo41$veces<-rep(2,times=141)
names(tiempo41)<-c("fecha","veces")
expanded41 <-tiempo41[rep(row.names(tiempo41), tiempo41$veces), ]
data.frame(expanded41,Date=expanded41$fecha+(sequence(tiempo41$veces)-1))
nombres41 <- rep(c("Nacional", "Extranjera"),times=141)
nombres41<-as.data.frame(nombres41)
moneda<-tibble(expanded41$fecha, tab_inst43$tab_inst, nombres41$nombres)
names(moneda)<-c("Meses","Participacion", "Moneda")
ggplot(moneda, aes(x=Meses, y=Participacion, fill=Moneda)) +
geom_area(alpha=0.7, size=0.2, colour="black")+ggtitle("Gráfica 3.5 Evolución de la composición de la deuda del sector \n privado no financiero en moneda Nacional y Extranjera, \n de julio de 2009 a marzo de 2021 (en porcentajes)") +
theme(
plot.title = element_text(color="black", size=10, face="bold", hjust= c(0.5))
)
datosej3 <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/Tarea-1/Datos%20Tarea%201/datos_ejercicio3.csv")
#datosej3 <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/Tarea-1/Datos%20Tarea%201/datos_ejercicio3.csv")
datosej3 <- read_csv("C:/Users/Leobardo/Documents/GitHub/TareasMacroII/Tarea 1/Datos Tarea 1/datos_ejercicio3.csv")
